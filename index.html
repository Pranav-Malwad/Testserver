<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testing visitors count</title>
</head>
<body>
    <h1>Test Server (testing visitors count)</h1>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DW3YVHNSZT"></script>


<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DW3YVHNSZT');
</script>




    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const API_KEY = 'AIzaSyCj7yRzO5YDUsgTojlb7O1paIHIwfouGXg'; // Replace with your API Key
        const VIEW_ID = '337719460'; // Replace with your Google Analytics View (Profile) ID

        // Load the Google API client library
        function loadGapi() {
            gapi.load('client', () => {
                gapi.client.init({
                    apiKey: API_KEY,
                    discoveryDocs: ['https://analyticsreporting.googleapis.com/$discovery/rest?version=v4'],
                }).then(() => {
                    getAnalyticsData();
                }).catch(err => {
                    console.error('Error initializing API client:', err);
                });
            });
        }

        // Fetch Google Analytics data
        function getAnalyticsData() {
            const request = {
                'viewId': VIEW_ID,
                'dateRanges': [
                    {
                        'startDate': '7daysAgo', // Example: past 7 days
                        'endDate': 'today',
                    }
                ],
                'metrics': [
                    {
                        'expression': 'ga:sessions' // Total visitors (sessions)
                    },
                    {
                        'expression': 'ga:activeUsers' // Active users
                    }
                ]
            };

            // Make the API request
            gapi.client.analyticsreporting.reports.batchGet({
                'resource': {
                    'reportRequests': [request]
                }
            }).then(response => {
                const report = response.result.reports[0];
                const totalVisitors = report.data.totals[0].values[0];
                const activeUsers = report.data.totals[0].values[1];
                document.getElementById('active-users').innerText = `Active Users: ${activeUsers}`;
                document.getElementById('total-visitors').innerText = `Total Visitors: ${totalVisitors}`;
            }).catch(err => {
                console.error('Error fetching Google Analytics data:', err);
            });
        }

        // Load the Google API client library on page load
        document.addEventListener('DOMContentLoaded', loadGapi);
    </script>


    <h1>Website Analytics</h1>
    <p id="active-users">Active Users: Loading...</p>
    <p id="total-visitors">Total Visitors: Loading...</p>



    
</body>
</html>